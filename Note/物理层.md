+ 找一个渠道，将信号通过物理方式发送
+ 让上层感受不到介质间的区别
+ 发送方：发送的信息交予物理层，由物理层发送给接收方的物理层
## 物理层该干的活

+ 确定与传输媒体接口相关的一些特性：
	+ 机械特性：接口所用接线器的形状和尺寸
	+ 电气特性：接口电缆能够接受的电压范围
	+ 功能特性：物理接口上各条信号线的功能分配和具体定义
	+ 规格/过程特性：定义信号线之间的工作顺序和时序


## 基本概念

+ 数据是需要传送的信息，信号是数据在传输过程中的存在形式
+ 承载信号的physical path被称为(物理)链路link：比如一条光纤
+ 一条物理链路可以通过分时、分频等方式容纳多个信道(channel，又称逻辑链路)
+ 比特率/数据率（bit rate/data rate）：单位时间内传输的信息中bit的数目（**数据量/时间**），bps/kbps/Mbps/Gbps...
+ 带宽**BandWidth**

### 奈奎斯特定理

> Nyquist's theorem
+ 在理想（无噪声）低通（带宽有限）信道中，极限码元传输速率是 2W Baud，其中 W 是理想低通信道的（模拟）带宽(***那么symbol rate为2W***)。若用 V 表示每个码元离散电平的数目（即其可以取的离散值的个数；**即其进制数**），则极限数据率为 $2W log_2 V (b/s)$
- 例如，一条无噪声（有无噪声都适用）的 8kHz 信道，每个信号包含 8 级，则最大传输速率为 $2 * 8kHz * log_2 8 bit = 48kb/s$
> 解释
+ 对于带宽为W的信号，需要2W的频率进行采样

### 带宽

1. 传输介质的物理特性，**频带宽度**，单位为Hz
2. **Data Rate的最大值**，单位为bps等
> 基带信号：0~B Hz的信号

> 通带信号：将基带信号移动后得到的信号，S~S+B Hz

### 码元(symbol)

> 一次信号变化的可能结果
+ 或者说一次采样得到的结果？
> symbol rate/ baud rate：单位时间内传输的symbol数目，即单位时间内可能发生的信号变化次数
+ e.g. 四进制码元可以携带2bit(00 01 10 11, $log_24$)信息，如果data rate = 64kbps则 symbol rate = 32kBaud(32k symbol/s)

### 香农定理

> Shannon's theorem
+ 在**受高斯白噪声干扰**（无噪声不适用）的低通信道中，用 W 表示信道的（模拟）带宽，S 表示信号平均功率，N 表示高斯噪声功率，则**极限数据率是 $W log_2(1 + S/N) (b/s)$**

> 信噪比 Signal-to-Noise Ratio
- SNR公式中的 S/N 就是信噪比，没有单位；但为了方便表示更大的范围，也用 10lg(S/N) 表示信噪比，单位为分贝 dB（事实上 dB 本来就是一个比例单位）。如果看到 dB 为单位的信噪比，应换算为 S/N 再代入公式。

+ e.g. 二进制信号在信噪比为 127:1 的 4kHz 信道上传输，求最大数据传输速率。
+ 根据 Nyquist's theroem，最大数据率为 2 * 4k * log_2(2) b/s = 8kb/s；
+ 根据 Shannon's theroem，最大数据率为 4k * log_2(1+127) b/s = 28kb/s。二者均为上界，取较小的一个，因此最大数据传输速率为 8kb/s。

> 以上两定理都用于求极限数据率

## 信息交互方式

### 单工链路 simplex link

+ 1条信道，固定单向通信

### 半双工链路 half-duplex link

+ 2条信道，双向可通但不能同时通信

### 全双工链路 full-duplex link

+ 2条信道，两边可以同时收发
> 不一定需要两条物理链路

## 传输介质/传输媒体 Transmission Media

### 导向传输介质
+ 磁介质
+ 双绞线(**twisted pair**)
	+ 屏蔽双绞线 STP
	+ 非屏蔽双绞线 UTP
+ 同轴电缆 (**coaxial cable**)
+ 光纤(**fiber optics**)

### 非导向传输介质
+ 无线电波(Radio)
+ 微波、红外线、激光


## 数字调制 digital modulation

### 基带传输 Baseband transmission

+ 如下图
![[1.png]]
1. a为待发送的bit流
2. b为十分朴素的发送方式，对于一段连续的1，接收方如何正确知道1的个数呢，引入时钟线可能可行，如果没有时钟线，可能会失去同步
3. c为NRZI，发1跳变，0不变，解决了全1的问题
4. d为曼彻斯特编码，通过**将待发送信号与clk异或**之后再发送，然而编码效率降低
5. e为AMI，见后

#### 扰频/倒频 scrambling

+ 尝试解决一长串 0 和 1 的问题。发送数据之前，用一个伪随机序列 XOR 数据，接收器用同样的序列 XOR 后得到结果。问题：不能完全保证不会出现一长串 0 或 1；尤其是序列较短之类的情况可能出错或被恶意用户攻击。

#### 双极编码 bipolar encoding / AMI, Alternate Mark Inversion
- 这种编码方式关注信号的平衡性；短时间内正电压和负电压一样多的信号称为平衡信号 balanced signal，这样的信号均值为 0，即没有直流分量；由于传输介质的物理性质，没有直流分量是一个优点。这种编码方式用 +1 或者 -1 表示 1，每次的 1 与前一次的 1 表示法相反，保证最多只差 1 个；用 0 表示 0。

> 还有一种 8B/10B 编码模式 同时考虑这些问题，通过映射保证没有超过 5 个连续的 0 或 1，同时保持 0 和 1 数目相对均等；其额外带宽消耗也只有 25%。



### 通带传输 

+ 通过调节载波信号的幅值、相位或频率来运载数据，占据以载波信号频率为中心的一段频带，用于无线和光纤信道。
+ 方波的发送需要无穷大的频率
+ 参考：[无线通信为什么不直接发送方波信号？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/486885340)

#### 幅移键控 Amplitude Shift Keying(ASK)
+ 通过两个不同的振幅分别表示 0 和 1；可以用更多的幅值等级表示更多的信息。

#### 频移键控 FSK, Frequency Shift Keying
+ 类似地，通过不同频率表示不同的码元。

#### 相移键控 PSK, Phase Shift Keying
- 将载波波形偏移一定的相位。二进制相移键控 BPSK, Binary PSK 将波形偏移 0° 和 180°；正交相移键控 QPSK, Quadrature PSK 将波形偏移 45°, 135°, 225° 和 315°。

- 为了让每个码元传输更多 bit 的信息，也可以将这些方式综合起来使用。下面的 星座图 constellation diagram 中用黑点表示一个合法的振幅和相位的组合；其中每个黑点到原点的距离表示振幅，和 x 轴正方向所成角度表示相位偏移。该图中 (a) 即为前述 QPSK，而后面两个图是 正交调幅 QAM, Quadrature Amplitude Modulation 的两个实例，它们的每个 symbol 分别携带 4 bit 和 6 bit 的信息。![[2.png]]
- 为星座图分配每个黑点代表的 bit 时，需要考虑少量的突发噪音不会导致很多 bit 出错。可以使用 Gray code 解决这一问题，使得临近两种状态只有一位不同，这样出错的时候顶多一位出错：![[3.png]]


## 多路复用

#### 频分复用 FDM, Frequency Division Multiplexing

- 经过调制后，要传输的信号所占频带宽度是有限的；而线路可使用的带宽远大于这一宽度。我们可以对多路信号采用不同频率进行调制，使得调制后各路信号频率不同，不会互相干扰；即将信道带宽分割为多种不同频带的子信道，实现多路复用。
- 每个频带之间保留足够宽的距离，保证相邻的频带不会相互重叠。这一部分保护间隔称为 保护频带 guard band。
- ![](https://cdn.nlark.com/yuque/0/2021/png/641515/1633669695878-107b0f6e-d382-44b8-ad4a-639053b46f75.png)
##### 正交频分复用 OFDM, Orthogonal FDM

- 基本思想是：每个子载波相互正交；即每个子载波**在其他子载波的中心频率处能量为 0**。这样在每个子载波中心频率处取样，就不会被其他子载波干扰了。这样的方式不需要 guard band，且频带利用率很高。
- ![](https://cdn.nlark.com/yuque/0/2021/png/641515/1633669700504-b2555a6b-5874-4832-914a-6e5551ec170b.png)

#### 时分复用 TDM, Time Division Multiplexing

- 每个用户周期性地轮流工作，每次在一个非常短的时间内获得整个带宽。类似于频分复用，时分复用也可能会需要增加 保护时间 guard time。
- ![](https://cdn.nlark.com/yuque/0/2021/png/641515/1633670026498-78e9394e-50b0-4ca0-9ac3-04af1e734526.png)
- TDM 的调度方式是机械的。一种动态按需分配时间片的方式是 统计时分复用 STDM, Statistical TDM。这种方式效率高，但需要额外信息确认数据流向，因此技术上较为复杂。

#### 码分复用 CDM, Code Division Multiplexing

- 考虑这样的问题：我们有若干由 1 或 -1 组成的序列。对于每个序列$S$，用$\bar S$表示其反码。对于任意两个序列S和T，定义其归一化内积$S⋅T≡{1\over m}\sum_{i-1}^m​S_i​T_i​$，其中m是序列的长度，此处为 8。容易理解，有$S·S=1$，$S·\bar S =-1$。若$S·T =0$，我们称这两个序列是 **正交 (orthogonal)** 的



## 公共电话交换网络

### The Public Switch Telephone Network, PSTN

+ 图示![[4.png]]

### 本地回路 Local Loop


### 中继线 Trunk
#### codec
#### 波分复用

### 交换 Switching

+ circuit电路交换，先建立连接，发送，释放连接，中间发送时直接发送所有信息，不保存
> 电路交换 Circuit Switching——先建立连接，然后直接发，最后释放连接；过程中路径被独占。途径的结点收到就立刻发给下一个结点，不储存。
+ ![[7.png]]
+ A先发送给B，B保存，等着给C发...
> -报文交换 Message Switching——不需要建立连接。报文携带目的地址和源地址，途中每个结点在收到整个 message 以后再找下一条路进行传输。这样可以动态选择合适空闲的线路，增加线路的可靠性和利用率。但是会引起转发时延，并需要缓存空间。
+ ![[6.png]]
> 分组交换 / 包交换 Packet Switching——将报文合理分块，增加携带分组编号等信息。在报文交换的基础上，缩短了时延，减少了期望的出错重发数据量，同时由于 packet 的长度有所限制，存储管理也方便了很多；动态寻找线路时各个 packet 也可以选择不同路径（因此，packet 的数据不一定按序到达）。问题是额外信息量进一步增加，且发送前和接收后的工作量也会增加。
+ ![[8.png]]
